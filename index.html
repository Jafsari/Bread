<script src="https://checkout-sandbox.getbread.com/bread.js" data-api-key="4dbfe30f-0841-45bf-b281-7de2f2c62a49"></script>
<form id="bread-checkout-form" action="/confirm" method="POST">
  <div id="bread-checkout-btn" data-bread-default-size="true"></div>
  <script>
 var opts = {
        buttonId: 'bread-checkout-btn',
        actAsLabel: false, 
        asLowAs: true, //Displays price per month to logged out users
       items: [
        {
          name:'Overwatch',
          price:10000,
          sku:'Overwatch123',
          imageUrl:'[https://images-na.ssl-images-amazon.com/images/I/51jI2r-gFDL._AC_SX215_.jpg]',
          detailUrl:'[https://www.amazon.com/Overwatch-Game-Year-Xbox-One/dp/B0733HQQQQ/ref=sr_1_1?ie=UTF8&qid=1525642686&sr=8-1&keywords=overwatch+game]', 
          quantity: 1
        }],
        shippingOptions:[{
          typeId:001,
          cost:700,
          type:'Two-Day Shipping'
        },
        {
          typeId:002,
          cost:1500,
          type:'Overnight Shipping'
        }
        ],
        shippingOptions:[{
          typeId:001,
          cost:700,
          type:'Two-Day Shipping'
        },
        {
          typeId:002,
          cost:1500,
          type:'Overnight Shipping'
        }
        ],
        billingContact:{
          firstName:'Justin',
          lastName:'Afsari',
          address:'126 1ST AVE APT 2R',
          zip:'94550',
          city:'New York',
          state:'NY',
          phone:'925-300-5184',
          email:'afsarijustin@gmail.com'
        },
        shippingContact:{
          fullName: 'Justin Afsari',
          address:'126 1ST AVE APT 2R',
          zip:'94550',
          city:'New York',
          state:'NY',
          phone:'925-300-5184'
        },
        calculateTax: function(shippingContact,callback){
            if(shippingContact.state === 'NY') { // check to see if address is in New York
          var shippingTotal = shippingContact.selectedShippingOption.cost; // I want to include the shipping with the calculation of my tax
          //selectedShippingOption is a property of shippingContact that changes as I dynamically change the shipping option.
           for (let i = 0; i < opts.items.length ; i++){
             shippingTotal += opts.items[i].price * opts.items[i].quantity //Include the price + quantity of the elements within opts.items
             var nyTax = shippingTotal * .05 // New York tax
           }
          callback(null, nyTax); //Use the callback to return the calculated Tax for NY
        } else {
          callback(null, 0); // Else for not NY
        }
      },
      done: function(err,txtoken){
        // If their is an error, return an error else append a message to the user
        if (err){
          console.error(`Error:${err}`)
        } else {
          console.log(`tx_token:${txtoken}`)
        }
        let status = document.querySelector('#status')
        let success = document.createElement("li")
        status.appendChild(success)
        success.innerHTML = "Thank you for your purchase, you may now proceed!"
        }
  };
  bread.checkout(opts);
  </script>
</form>